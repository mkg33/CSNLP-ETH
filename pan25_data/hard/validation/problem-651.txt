Just think of the bullshit that could flow from that scenario.
Say you were an employee of the state of Texas and your spouse was getting cancer treatment paid for through being on your family plan.
All of a sudden, they'd be off that insurance and you'd have to pay out of pocket.
You'd no longer be considered next of kin, so if your now-ex couldn't make medical decisions for themselves then their family that might hate you for being gay would be in charge instead and could tell the hospital not to even let you visit (a very real concern for gay couples before Obergefell, even if they had powers of attorney).
And if they had kids you hadn't adopted and they died?
The kids would be taken away from you because you would have no legal relationship to them.
Then in that case the compromise of "you can serve, but you have to stay in the closet" was a shitty result, but it was a lot better than "you can't serve at all, and the cops will track you down to kick you out.
".
This is how it should be.
It is a bit crazy how closely intertwined religion still is with government, and the ramifications that has for everyone.
It makes no sense for "marriage" to have arbitrary religious qualifications when marriage holds legal weight for everyone.
Look up the arguments of the early 2000s and you see the talking points that marriage is by its nature a religious contract.
I'd argue that the very premise of the religious right against gay marriage has always been around its religious aspects.
I would imagine they'd say something about how this law violates someone's religious freedom to deny gay people the rights of marriage.
Maybe not strike it down entirely, but rule that any court clerk who wants to be bigoted would have the right to refuse to accept your marriage.