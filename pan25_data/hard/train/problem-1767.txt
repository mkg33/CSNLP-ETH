It's a common tactic many countries use.
Turn the people against each other so that they don't turn against you.
We are seeing this play out in the United States right now.
Turning the population against itself so that they don't realize that the government is the true problem.
That's about 10 million Iranians who side with those religious hardliners.
Potential extremists.
The weaker they become the more violent they will become.
This is also historical fact.
When a religious group that has been in power begins to lose power violence happens.
Body's pile up.
Step 5: use your military to stop the violence.
Tell the world you are trying to stop the "violent hardliners" while you really go after those who have been protesting.
They wouldn't have done this if they had any choice, they're going to find a way to save face and then give the protesters what they want and ensure everyone shuts up.
They're not going to secretly come after the protesters because if they've done this, it's because they were seriously afraid of being toppled, which means there are too many to punish.