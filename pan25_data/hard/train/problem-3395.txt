One of the conditions for joining NATO is that the country must have resolved any conflicts with its neighbors or other countries in accordance with international law.
Whether NATO would actually accept or refuse an application is a matter of politics, and not alliance rules.
Furtherrmore, given that these guidelines are not part of the treaty text, NATO can simply change or override these rules if desired.
So again, the decision on whether or not Ukraine can join NATO or not, is a political decision, and not an automatic one based on this rule you're imagining is a hardcoded one when it isn't.
Allow Ukraine to join NATO (or come up with another security pact) with a caveat that if attacked, nations can choose to support or not and if that then supporting NATO country is attacked by Russia there is no automatic need for NATO to jump in as the "one attacked is an attack on all members" maybe why some are reluctant to let Ukraine in.
So, I guess a non-NATO guarantee of military support by individual nations is probably the best way forward for Ukraine.