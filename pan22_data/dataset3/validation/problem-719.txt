You will probably get more "mileage" with a wiring test set to ensure there are no physical issues with the cabling (mis-match of pairs, length tolerance, physical damage, etc.
AFAIK a hub means that both cables plugged into the hub need to be shorter than the Ethernet Max Length, where as a switch stores and forwards the packet, so perhaps you can get the max length on both sides of the switch.
I brought the same computer into the network closet and plugged it directly into the hub and everything works okay, so it must be the wiring through the walls.
It'll be cheaper than re-cabling your whole office.
With the prices of switches, there's never any reason to use a hub.
You can hire these testers, but it can be expensive.
Or is there an inexpensive hardware test, short of pulling the cable back through the walls?
We have just started using an existing Cat5e cable to run 100Base-T to a new office, but unfortunately, machines in the new office see link but receive an APIPA address (169.254.x.x).
Can I use Wireshark or some other (Mac) software to confirm this?
Don't forget that there are Ethernet Specifications which dictate how long your runs can be, how many hubs/switches etc.