To view the banned addresses and rules in the banned chain:
I have a number of daemons running on my servers checking the syslog files and weblogs, so if anything nasty is being attempted by anyone, their address is automatically banned for a few days, depending on type and severity and number of previous attacks.
"The question is: How can I list the blocked IP addresses?"
Add jump to banned chain in the INPUT chain before most other rules
The addresses are also distributed to every other machine in the cluster over mysql replication so they are also protected and keep in sync.
If more would use it then I hope it would have more impact.
After 10 years of work, I hope to make it available for everyone to use soon.
You can also use it like a database with the comment options, so you can know when and why etc.
flock is important when iptables is being frequently updated by many processes - it appears that iptables doesn't have any locking built in to it.
I currently have about 1.5 million ip address histories and hundreds of thousands of mail and ssh attacks reported, helping to clean the net.
My software also looks up the owner of the network and mails a complaint to the ISP.
The info is logged into a mysql database, and periodically expired.