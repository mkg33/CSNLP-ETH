I plotted both of these series on a doughnut chart, using a patterned fill to distinguish categories X2 from X1:
(Ideally I would like to get rid of the small circle in the middle, but I can live with this if necessary).
This more or less creates the graph that I want, except that the legend now displays the two series rather than the category labels.
I have found an approximate way of doing this - these are the steps I followed.
I then swapped the series around and added data labels to the consolidated series with numbers formatted so that "0%" never shows:
How can I get the legend to show Category A, B, C rather than Series 1 and 2?
I want to create a pie chart with data labels which refer to more than one segment.
At this stage I then changed the name of categories X1 to just X and deleted the categories X2 so that the legend displays only the overall categories:
I started by creating an extra column consolidating the data:
Either from this graph or using a completely different approach.
Finally, I changed the central doughnut to a pie and made the hole as small as possible:
I want to create a pie chart that reflect all of these segments, but apply % labels to just the overall categories A, B and C.