Lithium Ion batteries are sensitive to temperature, and there is hardware in the battery that may disable charging if the battery gets too hot.
When the system is under a higher load and the system temperature increases, the battery will stop charging altogether.
Which leads me to believe that the charger is probably also dead, but I can't say for sure.
It's gotten the the point where the battery actually discharges entirely after about  2 hours of working on it while it's connected to the wall socket.
This is a common symptom of a battery that is failing.
Laptop ran fine for a bit, then turned off instantly under load.
Moreover, if your charger isn't providing enough current to charge the battery and run the laptop under high load, the battery will drain and the system will shut down, even when plugged in.
The charging LED goes on and off, and the battery tray icon also displays it as such.
This is about my roughly 4 years old Asus N551JK, in case it matters.
It constantly thinks it's being unplugged and plugged back in.
The problem is, I don't know if the battery or the charger is to blame.
It could fail to charge the battery because either of them are broken ...
Without being plugged in the battery dies after about 30-60 minutes, so I know that it's in a bad state for sure, but not necessarily "broken".
I agree with K7AAY, this is likely to be a battery problem.
I am fairly convinced it's not a software issue, so that's ruled out.
Whenever the laptop is under heavy load (android studio running, for instance) the battery is acting really weird.