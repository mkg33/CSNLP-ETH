You would have to go the paid route and might have to use a player such as Arcsoft TotalMedia Theatre or PowerDVD.
AC3Filter (a decoder and processor filter) can allow downmixing to Dolby Surround/Pro Logic or Dolby Pro Logic II, if configured to do so.
Speaking of which, your best bet might be to get an external sound card that supports Dolby Pro-Logic matrix encoding.
In the sound card, activate STEREO (which means, tell your PC that you only have two normal spekaers connecter to the main green output).
http://mewiki.project357.com/wiki/FFDShow_reference#Mixer
What I want is some way for the OS, Windows 7, to act as if I really had 5.1 audio channels available, so applications produce surround audio, but before outputting it out of the back of my PC, apply Dolby Pro-Logic matrix encoding so that it outputs over only two channels.
These two channels would then get sent to my receiver via a RCA cable, which would decode it again and drive the surround speakers.
Though since Dolby Pro-Logic is a licensed format, I doubt you will find support for converting audio streams to it using open source codecs.
If your surround sound receiver supports a coax/optical S/PDIF, then you could use that.
In the input, choose "original", on the output, choose "DolbyPrologic".
You don't have to encode the movies, just use Kmplayer to output the sound as a prologic sound.
I'm pretty sure I could do it at an application / codec level, but I'm looking for something that I just have to set once.
Your media player must also be configured to use AC3Filter.
It was used in surround sound systems in the last century.
But I have a really old surround sound reciever that only has a two-channel, L/R input, which it extracts 4 channels of audio from, and outputs to 5.1 speakers.
It provides a number of options with regards to downmixing including Dolby Pro-Logic II.
First off, I'm talking about Dolby Pro-Logic, a really old tech for encoding 4 audio channels (L/R/C/SR) into two analog outputs, and then extracting them again.
I have a modern PC that can output 5.1 analog audio (Three outputs on the back carry six channels of audio).
If your computer does not have the necessary connector, you can pickup a sound card (external or interal) that supports the format/connector and go that way.