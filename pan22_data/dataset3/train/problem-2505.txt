I've never played with it much but I've heard good things about netdisco:
It comes with a "stencil" for electronics that you might find on a network.
HP's Network Node Manager performs automatic discovery of your network, and can provide a graphical output of what it has discovered, along with links between devices.
If you find a program that can scan a network and export GraphViz files, then you can use OmniGraffle to make pretty graphs.
Note: the dude is the full version of the software that someone else has listed here.
To create a textual representation of the network, use nmap, if you want a GUI use Zenmap GUI
There is an app I use called "kiss the net" that scans and generates a pdf network map for you.
EDIT: Well, you now changed your post to say that you'd like an automated solution, but I'll leave my post here.
I don't know if it supports exporting that data to an editable image format; in any case, most people I've talked to have always preferred manually created diagrams as they tend to be clearer and better laid out.
Requirements: Windows XP/2000/2003/Vista with Internet Explorer 6 or better.
As far as creating a visual representation of the output, you're going to need to do that manually (e.g.
This one simply generates a network map along with a table of machines it discovers.
I'm not sure if you're looking for an automated solution, but OmniGraffle is a great Mac application  for making flowcharts and the like.
It's actually based on a server monitoring/management product called "The Dude" made by mikrotik.