then the next if statements that you come to are indented again, and they really shouldn't be, this makes them look like they should be inside of another code block.
it really looks like there are two people writing this code.
in your if statements you consistently use brackets, even for one liners, but then in the else statement you don't use any brackets,  this gets confusing and can lead to you not knowing where the statement really ends, it is better coding practice to use the brackets (in my opinion).
I keep going and find a Function indented where it shouldn't be.
in one of your functions you have two different coding styles.
you want to be able to read the code and be able to tell what is going on, even if you have learned more about the language and would do things differently, you should still be able to read the code easily.
my suggestion is that if you borrow code from somewhere else that you style it the way that you would write it so that it is easier for you to read in a year, or two or more.
you don't want to look back at your code and think to yourself "what was a I doing here?"