And this will be a full-time job -- one update could come down that completely changes the pattern of network activity and thus breaking your system.
Internet service providers are gradually chipping away at net neutrality and imposing bandwidth limits.
Trust me, I spend many hours a month monitoring and adjusting rules, tuning alerts, etc.
Yet, I either didn't learn enough or simply don't recall that any of them by themselves provided a good comprehensive solution to this impending problem.
MRTG is a good tool to generate pretty graphs of bandwidth usage, but if you want to know who is generating the traffic, using tcpdump or one of the pcap statistics aggregation tools is your best bet.
I'd also like to block particular network chatter to certain advertisement servers or other CDNs.
Should I use a combination of all three or is there a better or easier solution?
The firewall will also need to have ip forwarding turned on.
Many years ago I tinkered with IP tables, firewalls, and proxies on Ubuntu.
There are tons of tutorials on getting a setup like this working.
(Yes, two interfaces is not strictly necessary, but it is a lot simpler to set up and think about).
You will want to use iptables to control (permit, deny) traffic, and you will also need to use iptables to MASQUERADE (NAT) all of the local traffic to the (presumably) single IP address given to the firewall by your ISP.
pcap and the linux interface statistics will be your tool to monitor what is going on.
I'd like to have a fine level of control over the data leaving my network and coming into it, view reports about attempted traffic, create comprehensive logs, and easily configure the service to permit or deny acceptable types of traffic or devices.
I've seen plug-ins for Firefox that re-write html to avoid downloading bulky video advertisements.
For example, I'd like to identify the connections and type of data a PS3, Xbox, Wii generates when attempting to download an update, deny or permit on my schedule, yet always allow online gaming traffic.
Once you have a box setup you can also use Etherape to get a visual representation of traffic and connection end-points.
Unless documented, you're going to have to sniff a boatload of traffic to determine activity/ports/protocols for each device, especially the "black box" devices like the gaming systems.
I should have provided all of the necessary keywords to get you going.
Most users will need to trust their ISP to report accurate bandwidth consumption rates, and most will not be able to control the traffic generated by many devices on their home network.
I'd like a little advice about where things are now.
Stick a linux host with two interfaces as a firewall between your local network and the internet.
I'd like to be able to configure this service or application on a virtual machine running Ubuntu server on my network.
You then have full monitoring and control over all traffic.
for a secure data center with only a half dozen hosts.