You may also look into 3rd party software like CC cleaner to try to get rid of latent processes that you don't need.
By default windows vista has the shutdown button set to put the computer to Sleep, you can click the small right arrow then choose shut down from there or follow these instructions to set up the shut down button correctly.
In addition if there ever was a point in time when it did shut down, use system restore to back it to that point.
You could get an ubuntu live boot CD/USB and see if it shuts down correctly and if it does then the issue is definitely with your current OS and you may want to reinstall your OS.
Also  If you have recently installed something, you may want to attempt to uninstall it and see if the issue continues.
Most likely a process that is supposed to be turned off after the video is hanging causing the system to stay on.
If all else fails, you will want to look into testing a different OS to see if it is a hardware or software issue.
Go into Ms Config and try to identify any unknown processes and stop them.