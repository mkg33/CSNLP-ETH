I had a hard crash on my Mac PowerBook and when I restarted, Mail came up with only my MobileMe account still available and I cannot figure out how to restore the other eight email accounts I have.
The directories in ~/Library/Mail all seem to be there. I even did an rsync of the modified .plist files from a TimeMachine backup of the directory from before the crash (unfortunately, I was on travel, so the backup is more than a week old and I'd like to try and recover from that point without having to entirely restore from TimeMachine).
So my questions are where exactly is the account information for Mac Mail kept? Any thoughts of what might have caused the failure? Why does only MobileMe come up? Any other thoughts on how to fix things?
So I tried a number of things and finally got things mostly back to where I wanted to be.
I tried using TimeMachine on the Inbox and did a restore from before the crash. This restored the contents of the email messages from that point, but put them in a new folder (called something like Time Machine) and did nothing for the accounts, which was the main goal. This wasn't much help, so I restored from a backup copy I had made of ~/Library/Mail.
I then restored ~/Library/Preferences/com.apple.mail.plist from before the crash. I had not tried this initially, because when I did a grep of one of my mail accounts in the ~/Library/Preferences directory, but the grep failed with "egrep: ringToFront.plist: invalid context length argument", which I didn't realize was a hard failure and it did not get to the other files. Doing a grep directly on com.* in the pre-crash TimeMachine directory gave "Binary file com.apple.mail.plist matches". Bingo. So I moved that file into place and restarted Mail.app with the old ~/Library/Mail directory in place and it caught up.
In Lion the paths are slightly different, the two files to try restoring from Time Machine are:
In my case the first did nothing, but the 2nd worked. Accounts.plist had obviously been truncated to 1kb. As to why, that's another question.