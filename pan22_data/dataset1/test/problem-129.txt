Since you tagged this C#, I'm going to go on the assumption you want to actually create your own program to retrieve this information. It's entirely feasible (and actually quite easy) to make your own program that lists all the installed software on a computer, and retrieve the product key if applicable.
Most software publishers have their own ways to encode the serial number of the product somewhere on the system (usually buried in the registry), so one downside of rolling your own program is that you have to maintain several different algorithms to decode the various product keys.
The last time I looked for an algorithm to decode Microsoft's product keys for my own program was a while ago, but I had a very hard time finding any algorithms on the internet. I ultimately stumbled upon Magical Jelly Bean Keyfinder that Pete listed and its source code which was on SourceForge (it seems this project has since morphed into Enchanted Keyfinder). It's programmed in Pascal, and I'm certainly no Pascal programmer, but I managed to convert it to C# in an afternoon (including usual interruptions from $DayJob) without any real issue.
There's one thing we have discovered which I will call out that is very important, and this is relevant if you roll your own software or even if you use some other key finding software. If the software is pre-installed on a machine (OEM Windows for example) the product key that is returned is the OEM product key and NOT the actual key for the product. Your install media WILL NOT accept this product key as it is from a different distribution channel.
If you're thinking running a program on all of your computers is saving you some time by not having to manually record the product keys, I think you'll be disappointed. Like I said, every software publisher does it differently and there is no standard. When it comes to re-installing the software after a computer has failed there's every chance the program won't have decoded the product key for one piece of software, and it will invariably be the most critical one.
There really is no substitute for dedicated software that you manually enter license information into and it keeps track of usage for you.
Personally I use MSKeyViewer Plus its freeware and seems to work very well for my needs. Hope this helps.