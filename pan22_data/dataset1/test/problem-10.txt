Ok so I have two identical databases in two parts of the world. I need to merge everything into the one I will call North (the other being South). North data trumps South data. I started thinking about a WHILE loop but am not sure that is the best/easiest way to go about this. My plan was to restore a copy of the South database onto the Instance where North lives and then do my work.
The table in question has ID, FirstName, LastName, Email and Login fields. And my rules are:
So my initial setup was something like this (which pretty sure I screwed up the Loop):
Not sure this is the right path to take or if I am doing something wrong/less-optimal for the Loop stuff. Thanks in advance for any help!
So I am assuming the tables look something like this (for my easy I am using table variables instead of physical/temp tables):
To scsimon's point, SQL really prefers to work in sets instead of iterations.  So anything you can do to avoid loops is preferred in almost all situations.   I think this should solve basically everything you need.  I may not have understood everything you wanted to do with the logging table when it came to inserting new rows into the North table.  But I definitely think this should be a framework you can work with.  I tried to make the code self-documenting but I can always explain something if that is needed.