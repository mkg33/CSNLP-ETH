I want to use HAProxy as a load balancer. I want to put two rabbitmq server behind haproxy. Both the rabbitmq server are on different instance of EC2. I have configure HAProxy server by following this reference. I works but the problem is messages are not published in roundrobin pattern. Messages are publish only on one server. Is there any different configuration for my requirement?
I have made some R&D on this and found that HAProxy is round robin the connection on the rabbitmq server. for ex: if i request for 10 connections then it will round robin the 10 connection over my 2 rabbitmq servers and publish the message. 
But the problem is I want to round robin the messages, not connection. i.e if i send 1000 msg at a time from 1 connection then 500 msg should go to rabbit server1 and 500 msg should go to rabbit server2. What should be the configuration that i have to follow?
As long as your client keeps open the connection to HAProxy, the connection from HAProxy to RabbitMQ connection won't move.  HAProxy is a connection-based load balancer, not message based (as far as I know).  It does not know when a message starts or ends (it would have to know the internal protocols for it to successfully do this).
In order to round robin the RabbitMQ servers, you'll need to have your client connect to HAProxy, send the message, then disconnect (don't keep the connection open).  Reconnect to send the next message, then disconnect.
Each time you reconnect, HAProxy will/should move you to a different server.