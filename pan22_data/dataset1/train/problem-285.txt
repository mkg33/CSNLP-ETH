Ehm, I stepped here looking for info about copype, and followed the link to the technet forum. There's a new post from a few days ago - I strongly recommend reading it. In short, copype is not broken at all: it is just meant to be run from the ADK environment (the cmd prompt called by clicking the apposite link in Start -> All Programs -> Windows Kits -> Windows ADK). (Oh well, this is the path on Win 7: I installed the Windows 8 ADK (version 6.3.9600.17029) on Windows 7; in Win 8, and probably also in Win 10, the path will be somewhat different due to the different layout of the Start menu.)
I'm writing a tool that sets up a WinPE Drive for you, and I have been calling DISM commands from an admin batch file. However, I cannot figure out how to run the copype command to set up the drive initially. "C:\Program Files (x86)\Windows Kits\10\Assessment and Deployment Kit\Windows Preinstallation Environment\copype.cmd" is where the copype tool is located but when calling it with dism with this command: Dism "C:\Program Files (x86)\Windows Kits\10\Assessment and Deployment Kit\Windows Preinstallation Environment\copype.cmd" amd64 C:\WinPE_amd64 it responds that Dism doesn't recognise the command-line option "copype.cmd" If I try running the file directly from a command prompt, it says it cannot find the amd64 infrastructure. The only way I can get it to start is if I run an administrator Deployment and Imaging Tools Environment and run the copype command. There must be a way to do this, but I cant figure out how.
Turns out the Windows ADK Copype has been a bit broken since Windows 8. It's missing some variable. If you put this in your batch file you can use call :copype to call commands to it:
For Anyone using Windows 8, you can see their solution here: https://social.technet.microsoft.com/Forums/ie/en-US/1155d38c-e7fd-4b4f-a31c-26875d4f47a7/windows-pe-error-using-windows-8-adk?forum=w8itproinstall