Note that the number of R2 cmdlets is greater than that of the plain 2008 server. I think this is the problem. The command that sticks out most is that the 2008 server lacks the "Start-WBBackup" command, which is needed to execute a backup. Interesting. Looks like I am going back to the WBadmin tool and running this stuff as a batch on my 2008 servers and saving powershell for 2008 R2
I recently put together a PowerShell Script on a server running Windows Server 2008 R2 that created a dated directory then started Windows Server Backup to make a system state backup. The script is run on a nightly basis and works great.
Anyone know if there is something different I should be doing on Server 2008 to make this work or is running backups from powershell simply not supported except on R2?
Wanting to use this on another server, I copied the script over and, after adding the WSB snapin from the powershell command line, only to find that it would not run.
The difference between the two servers is that this new server runs Server 2008 (not R2). Has anyone gotten powershell scripting to work for running backups on Windows Server 2008 with Windows Server Backup? I wonder if the commandlets are different. So far all the docs I find are based around R2.
I think this might have something to do with the cmdlets being different in regards to Windows Server Backup on 2008 and 2008 R2. Did a "get-command -module windows.serverbackup" and got the following cmdlets on the 2008 server: