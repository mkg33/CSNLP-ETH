First thought, remove that last if statement and see if you get any print out.  It looks like it's overwriting your output.
One of my tasks I need to do is Check if there are any Critical Updates. It seems like this would be easy enough but I'm having A LOT of trouble with it. I am not familiar with WSUS, I've never dealt with it but I need to communicate with it.
Logic looks good; it should have to go through all of the if-else statements to reach the "FAIL. Could not query Windows Update Server" text.
So, what is happening is it won't connect to Windows Update -- The object "Microsoft.Update.Session" uses the windows update agent to manage whether the updates are being handled by windows update or a WSUS, but sometimes it just doesn't do it and I don't have an explanation or even what I can do.
I've been trying to resolve this a few days but it is hard for me to test it and see it failing, I just get a phonecall stating a server slated for production failed when it isn't suppose to be.
I asked this question at Stack Overflow but they said I would have better luck here. I am using VBScript to automate a lot of server tasks, I'm simply checking to make sure the server build team did their job before the server actually gets used.
Anyways, on my test server and on other servers I have tried it on (only two others). It seems to work fine and it passes. In production, I'm getting a lot of errors where I get 