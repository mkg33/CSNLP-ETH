I have a few questions concerning qps-scale and how it is used when rate-limit option is used in BIND.
With my understanding reading the definition above, the "DNS query arrival rate" is the current number of queries per second being sent to the DNS server which changes dynamically NOT the capacity of queries per second the DNS server is able to handle.
is the qps-scale formula only used when the "DNS query arrival rate" is approximate or exceeds the qps-scale value?
Range allowed is 1 to very big number (actually 32 bit unsigned value, which is still a very big number). Default is not to apply qps-scaling. The rate limiting function calculates the approximate query per second load on the DNS from all sources (including TCP queries). The qps-scale, if defined, is then applied which may result in a reduction of the user supplied limits, such as responses-per-second during high-load situations. Thus, assume the user defined responses-per-second 10; and a qps-scale 200; then if the DNS server is receiving queries (from all sources, including TCP) at a rate of 500 per second the following algorithm is applied (qps-scale/DNS query arrival rate) * responses-per-second = effective rate-limit, substituting actual values gives (200/500) * 10 = 4, meaning that in the defined load conditions the 5th and subsequent identical response in any 1 second to any specific client will be dropped (or trigger any defined slip parameter action). The qps-scale value, if used, should thus be set to the maximum desired DNS transaction (query response) rate for the server.
First of all, I will just note that the "definition" you quote and ask about was written by a third party.
I think some of the confusion comes from some strange wording there and I would recommend focusing on the relevant section of the manual as that covers at least some of the things that you ask about.