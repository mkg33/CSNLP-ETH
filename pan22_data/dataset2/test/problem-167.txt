You are correct, storing it at 30-50% charge will increase the life as opposed to keeping it at 100% charge all the time. I have done this for years when using a notebook in a desktop environment.
The ideal thing is to use a "battery saver" feature, such as what Sony put on this laptop.  This lets you limit charging to either 50 or 80%, depending on the setting, so that the battery isn't overcharged.  But I gather that this feature is fairly rare.
I would allways remove the battery from the laptop when plugged into the AC as you are quite right they will lose more capacity when plugged in!
It seems like I may as well store the new battery for when it is needed, and continue to use the old batteries 40 minute life while I'm at the office.
I've read there is no benefit removing a battery when on AC power, however I've also read that a battery at 100% charge and ~35C will lose about 30% capacity a year, while a battery stored at 40% charge / 20C will lose 4% - which implies there is a massive benefit...
The problem with removing the battery is that, with most modern laptops, running without the battery limits performance (since the battery can't be used to supply power during peak demand periods).
The other option is to run on battery for a few minutes every other day or so -- just enough to run down to 80-90% charged.  This won't prevent the damage but will slow it considerably.
I've got a laptop that spends most of it's time as a desktop, plugged in on AC power for a few weeks, between occasional trips to the conference room or further afield.  On my last business trip, I realised battery life was down to 40 minutes, so I've bought a new battery.