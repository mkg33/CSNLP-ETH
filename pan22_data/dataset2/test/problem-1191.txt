I recently had this same issue. Assuming you are running AD CS, to resolve the issue remove the Active Directory Enrollment Policy settings within the GPO directing the client on where to locate certificate enrollment servers, and then added the same settings back:
Create a computer certificate using mmc snap-in 'certificates' by right clicking on 'Certificates' folder Under 'root\Personal' tree, and clicking All Tasks -> Request New Certificate. Certificate Enrollment window appears, you verify you are connected to your network and you are logged onto the domain. Then Click Next, which leads to a window stating the issue:
Under Certificate Enrollment Policy List, remove the Active Directory Enrollment Policy. Then re-add it and set it as the default. Perform a GPUPDATE on the client which is unable to see the certificate templates and attempt again.
i successfully created a certificate on the DCs that has the CA installed, but on the others i, like you, got the "Certificate types are not available" error.
You are following the right steps (http://support.microsoft.com/kb/316898/en-us), but the error likely means that you either have no enterprise certificate authority (CA) in the domain, or the CA is not accepting new certificate requests for some reason.  It may also be that your installed CA is not allowing generation of "Computer" certificate types.  This can be checked in the CA configuration.
I had the same problem manually requesting computer certificates although they worked automatically and there was no problem requesting user certificates.
i added the certificate to the trusted root CAs in the default domain policy, gpupdate on the DCs and it worked
The solution depends on whether you already have an enterprise CA set up and configured.  If not then you need to create one (there is guidance on the Microsoft technet site, but it's not trivial) or else use another way of generating self-signed SSL certificates such as one of the free downloadable tools.
I resolved the problem by changing IIS directory security settings to allow anonymous access for the PKI virtual directory only!
"You cannot request a certificate this time because no certificate types are available. If you need a certificate contact your administrator."