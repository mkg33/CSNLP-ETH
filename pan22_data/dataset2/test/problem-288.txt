I ran Database Engine Tuning Advisor and had it look at my plan cache (which had been building up for a few weeks) and added all of the statistics and indexes it recommended. After that I did a UPDATE STATISTICS on both clients and patients with the option FULLSCAN. After that I ran DBCC FREEPROCCACHE to clear out any old plans using the old statistics and indexes. I then ran the queries a few times to let the data get cached and any query plans that needed compiling let compile. After all that I ran the queries inside SQL Sentry Plan Explorer to get the numbers I have listed here.
Why does SQL think the first one is so much more expensive and why is my 2nd query taking so much longer when similar re-writes I performed did so much better?
I have a bit of a odd situation. I have two queries that produce the same result, according to SSMS and SQL Sentry Plan Explorer the first query should cost 95% and the 2nd query should cost 5%. However the first query completes in 132 ms and the second query completes in 8,531 ms.