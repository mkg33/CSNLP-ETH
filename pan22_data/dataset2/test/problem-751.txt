Now, I specifically reference the import-module command there because there's one difference between powershell VBA and powershell outside of vba...the ActiveDirectory module cannot be found.  If I add -noexit to the powershell invoking command to leave the shell open after the command fails, I can type:
Can anyone think of a way to get the AD module to show up to a powershell session launched from a VB macro in Excel 2007?
And the ActiveDirectory module isn't in the list.  The environment variable shows it's looking in the same places for modules as a regular powershell window (including under my user folder, so it's running under my context).  The AD module shows under -ListAvailable in a regular powershell window.
I have a powershell script I use to dump user and computer lists to csv files; it works great and I don't want to touch it much.  It uses the ActiveDirectory cmdlet, and the Get-ADComputer and Get-ADUser cmdlets.
I've tried modifying the import-module command to address the actual AD module as directly as possible, and I cannot get it to load.