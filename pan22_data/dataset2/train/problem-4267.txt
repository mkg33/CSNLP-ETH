Every Azure AD directory comes with an initial domain name in the form of domainname.onmicrosoft.com. The initial domain name cannot be changed or deleted, but you can add your corporate domain name to Azure AD as well. 
For example, your organization probably has other domain names used to do business and users who sign in using your corporate domain name. Adding custom domain names to Azure AD allows you to assign user names in the directory that are familiar to your users, such as ‘alice@contoso.com.’ instead of 'alice@.onmicrosoft.com'. The process is simple:
If you plan to federate your on-premises Windows Server AD with Azure AD, then you need to select the I plan to configure this domain for single sign-on with my local Active Directory checkbox when you run the Azure AD Connect tool to synchronize your directories. You also need to register the same domain name you select for federating with your on-premises directory in the Azure AD Domain step in the wizard. You can see what that step in the wizard looks like in these instructions. If you do not have the Azure AD Connect tool, you can download it here.
I have an issue where the following happened in the below sequence (and verified a second time with a test account, and O365 tennant in example is mydomain.onmicrosoft.com):
As per https://support.microsoft.com/en-us/help/2641663/how-to-use-smtp-matching-to-match-on-premises-user-accounts-to-office
First , we know that Office 365 uses the cloud-based user authentication service Azure Active Directory to manage users.
Any ideas please how i can link the listed testuser@mydomain.onmicrosoft.com (AD account) to testuser@mydomain.com (Office 365 mailbox) ?
I have followed the details here and set the local AD account email address under user profile to testuser@mydomain.com, set the UPN to mydomain.com, and also added the proxy address SMTP:testuser@mydomain.com under attributes tab of the user, but still get the same error.