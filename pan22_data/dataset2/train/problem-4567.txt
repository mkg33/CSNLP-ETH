I have a table with rows Date, Segment, Area , Province and Billing_nbr. I would also want a count distinct on Billing_nbr where total_revenue > 0 based from the ddate of that row going back to the first day of the month (ie Month To Date Count). This means that it should be a cumulative count of all billing_nbrs from the first day of the month to the date of observation (which is the ddate on each row). This means that if a billing_nbr occurs in the first day, it should also be included in the count for the second day even if it does not occur in the second day but should be counted once if it occurs in both days. And another normal count of the Billing_nbr where total_revenue > 0 grouped by other columns. Below is the data that I have:
The first join is for the grouped count and the second join is for the cumulative count from first day of the month up-to the date of observation (which is the ddate of each row) and it has to be grouped by other columns as well. The count columns are aliased A1_SUBSCRIBERS_TOTAL and TOTAL_MTD_A1_SUBSCRIBERS respectively. Below is that data I am getting and as you cant see I have identical counts on both columns but I want TOTAL_MTD_A1_SUBSCRIBERS to be a distinct cumulative count: