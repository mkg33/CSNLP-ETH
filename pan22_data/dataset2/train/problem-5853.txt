You could use an external program, such as a perl script, to do the rewriting, to catch more specialized cases, by using the RewriteMap directive. That'll bring in even more complications and decrease performance even more.
In my apache setup I would like to have number of directories named after domain names that will be served based on subdomain hierarchy. 
I would like to know if there is a better solution for this task and if my implementation has any pitfalls.
So far I only discovered that I need to specify "RewriteBase /" for scripts that rely on rewrite and supposed to be put on top level. 
mod_vhost_alias can't test existence of directories or manipulate request host as far as I know. Therefore it is not suitable for the task.
I'd say it's quite a clever way to do it. The obvious pitfall is that it's not going to work for your fourth example - you only strip off the first subdomain part, so foo.bar.shop.company.com will be translated to bar.shop.company.com instead of  shop.company.com