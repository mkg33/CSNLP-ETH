If you are only looking for a Windows based pbx you might also want to look at snom ONE. It will integrate to Lync Server and the snom phone handsets will work with Lync if you ever move up to lync.
I've seen a demo from an MS Lync product manager and he was insisting on the fact that Polycom was the only HW provider that was fully supporting Lync so far.
If my calculations are correct, using Lync as a pbx will be something like $250 per device/user for CAL's plus the server license so there is a little cost. But Lync sure has some incredible features.
That said, with FreeSwitch (free) in between as SIP switch if should be doable from waht I read at the moment. Trunk agaisnt FreeSwith (installed on the mediation server) and then hae FreeSwitch log in at your provider.
Supportdly it can - though getting support from vendors will be hard (seems it needs support for a trunk configuration that not all smaller ones will support).
The enterprise voice features require a 'Plus CAL'. There's not a great deal of information around on how Lync connects to SIP trunks or PSTN gateways though. 
For voicemail and autoattendant you need Exchange 2007 or 2010.  We use OCS 2007 R2 now with a SIP trunk from intelepeer.com for dialtone and it works great in a small business as long as you're willing to have all the infrastructure.