If I load test against any of the URLs listed with a redirect (ie, NOT the canonical URL which it is eventually forwarded to), it can serve 15000 concurrent connections without breaking a sweat.
I'm running a Django app, using uWsgi behind Nginx.  I've been doing some performance tuning and load testing using ApacheBench and have discovered something unexpected which I wonder if someone could explain for me.  In my Nginx config I have a rewrite directive which catches lots of different URL permutations and then forwards them to the canonical URL I wish to use, eg, it traps www.mysite.com/whatever, www.mysite.co.uk/whatever and forwards them all to http://mysite.com/whatever.
This doesn't make sense to me - I can understand why the requests involving a redirect may not handle quite so many concurrent connections, but it's happening the other way round.  Can anyone explain?  I'd really prefer it if the canonical URL was the one which could handle more traffic.
If I load test against the canonical URL, which the above test I would have expected got forwarded to anyway, it can't handle nearly as much.  It will drop about 4000 of the 15000 requests, and can only handle about 9000 reliably.