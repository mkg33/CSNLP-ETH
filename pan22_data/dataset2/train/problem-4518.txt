This would run at the gateway level. We are using all CentOS Linux. I would like to give out IPs by DHCP on the network.
You then create a signed certificate for signup.example.local and the aliases *.* and *.*.*  which is against all best practices but works well enough in specific cases.
I'm trying to come up with the cleanest way to redirect a user to a logon/payment page from an ISP gateway router. We run a small ISP and would like to force users to have to log in prior to getting onto the internet after connecting. 
I have thought about doing it with iptables (I have done it before with FreeBSD and ipfw's fwd action -- but not with iptables) and DNS. iptables seems like the better option -- since it would be easy to programmatically create/remove rules without having to reload or restart any service. But coping with secure connections (SSL) is problematic -- users would get certificate warnings when being redirected to the logon page.
You create your own CA and deploy the CA cert to the clients in their trusted CA root certificate stores. 