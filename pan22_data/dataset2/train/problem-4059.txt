I've been trying to install an anti-virus solution on my Windows XP SP3 machine but the installation programs keep telling me that I need a more current version of windows. Windows XP SP3 is listed among the supported platforms (AVG, Antivir, MSE). In particular, Antivir tells me that it requires Windows 2000 SP4 and update rollup, or above to work. AVG says it needs a "newer version of Windows." MSE (Microsoft Security Essentials) simply refuses to turn on real-time protection. Somehow, all of these anti-virus programs are not identifying the version of windows correctly.
For the record, there is an API call that can be made to identify the version of windows, however, these installers may be looking for something else which they rely on.
I've re-registered Softpub.dll, Wintrust.dll, Initpki.dll and Mssip32.dll. Still not identifying correctly.
How do installation programs determine Windows version and how can I properly reset it? Is it via a registry key or is there some file in system32 that I can add?
If it was just one poorly programmed installer, I'd let this pass, but now three different anti-virus installers are all mis-identifying my Windows version.
I had a previous anti-virus program installed and, as everyone suggests, uninstalled it prior to attempting to install the new one. I also used Revo Uninstaller to clean up unused registry keys and folders for this old anti-virus.
Did you do any backups before Revo Uninstaller did its cleanup? You might be able to restore from there. If not, you should try repairing the XP installation as Rowland suggested.
It may be the case that Revo Uninstaller has broken something badly (personally, I don't trust these third party uninstallers). I'd suggest doing a repair on your installation (and reapply service packs etc) and try again.