Note that this will clear all settings you may have in the printer, including things like IP the address.
First, check that the printer itself is not set to print greyscale only. I know the driver should override that setting, but check it anyway. I have not been able to find a manual that explains how to, but, if it's there, you should be able to find it under the Setup button on the control panel.
When one of the color cartridges is low, the screen will ask if you want to continue in color (poor quality) or in black/white. If you select black/white, you're kinda stuck in that mode. I couldn't find a way to reset it, so I reset the printer back to factory defaults. It was faster that way.
As the test page is also in grey, the problem is in the printer itself. There are 2 things I would try.
In system setup, supply settings, select color and Very Low setting.  This is where it's "hidden" that when you color toner gets low the printer will print in black/grayscale.  Select Continue and the printer will continue printing in color until the toner is actually gone.
If that does not help, I would reset the printer to factory defaults, as follows (from the User's Guide, pg 150):