I currently have lookup function that takes a code, looks for it on a specific column and gives me a price value on a specific column based on the code. I use this function many times, for different months, but soon I will have different output information for certain months and it will keep changing.
If you use a Vlookup or a similar technique, you can change the formula to look up the column based on the date.
It will return the price from the year columns, based on the date in column A. The Match function uses the year of the date in column A and then looks for that year in the first row of the lookup table. It returns the number of the column with the matching year. 
So what I need is a way for the lookup function to take into consideration the code and the date (that will be a few rows before the lookup function), so that the output column with the prices is selected based on the date, and then based on the code I get the right price.
Instead of having one column with prices I'll have many, and which one to look in will depend on the date. So I need to adjust that lookup formula.