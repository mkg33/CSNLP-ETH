Column B -  Appraisal - 1/07/2015 - 8/07/2015 - 6/07/2015 - "Blank" -   "Blank" -   3/07/2015 - "Blank" -
If you're on Excel 2007 or newer, you'll need to save the worksheet in the XLSM (macro-enabled) format.
I would like a function that checks the Dept column for a particular Dept type (e.g. "Sales") and if equals "Sales" then checks the corresponding rows of the Appraisal column and counts how many dates. I would then replicate for all other Dept types. So for the "Sales" example, if there are four employees and two have an appraisal date, the result would be "2". Noting that I don't want it to count the dates in Column B relating to the other Dept types.
For those wondering why CountRange must be passed to the custom function even though it isn't used, it's needed to have Excel recalculate the count if the date column is changed. In other words, passing the extra range to the function creates a dependency in Excel's calculations.
Column A -  Dept          .      .    .    .    -   HR -    Sales - HR -    Payroll -   Sales - Sales - Sales .
Press the Save button on the toolbar, then close the VBA Editor to return to your spreadsheet. You can now use the DEPTAPPCOUNT function just like Excel intrinsic functions. If your department column spans from A2 to A7 (and the appraisal dates are in B2 to B7 - the counted column must be immediately to the right of the department column for this function to work), enter =DEPTAPPCOUNT("Sales", A2:A7, B2:B7) to get the number of sales entries with non-blank appraisal dates. Adjust the first parameter (the Sales text) as desired to count in other departments.
I have a spreadsheet of employees. Column A is a list of Dept types (sales, HR, payroll, etc). Column B is the date their appraisal is completed, or blank if incomplete.
Open the VBA Editor, then choose Module from the Insert menu. Paste the following into the resulting text field: