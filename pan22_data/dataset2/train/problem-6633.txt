We went with a solution called Swyx for our VoIP integration a few reasons, and it has been FANTASTIC, and we've rolled it out to three offices since then.
We also do CRM systems, and our client wanted a CRM that would auto-dial customers who had requested support, and when a customer called in the call would automatically be routed to the person who last handelled it based on their Caller ID and whatnot.
You can be your own VoIP PBX, in that you have trunks coming into your office, and then you run a full VoIP system inside the office. This is what we do. There is not a single analogue phone in any of our sites. In fact there's not even a single desk phone at all. It's all VoIP and fancy USB headsets.
To do this though, you still need to get trunks into the office. Some of our customers (high volume ones) use ISDN. Our main ISDN provider in Australia has a product called "On-Ramp" and most of our customers get 20 lines and about 200 numbers.
Wow, to be honestl that was a bit of 'TL;DR' happening for me, but I scanned it and it sounds like you want to do something very similar to something our company did.
I hope this sheds some light for you, and good luck. It was the most fun project I've ever worked on, and being able to see the immediate benefit in every aspect of the business after deployment was heart warming!
Now, as for "Free/Open Source", remember it's only free if your time is worthless. We investigated doing this with Asterisk and we found that by the time we learnt Asterisk, developed an API we could interface with from our Windows apps, set up auto-dialling, redundancy and customised inbound call routing based on the dialling number's history we were talking about in the order of $150,000 in hardware, support and development costs. I think going the Swyx route was about $50,000 cheaper, because the 50k outlay covered about 100k of our own development costs (but we're not particularly cheap, your mileagage on those sums may vary).
We do have a smaller site that utilises two VoIP providers. One VoIP provider came with their office internet connection, and offers free national calls and are very stable, and they do permit this functionality (within reason of course). They've shuffled 10 calls at once down the single VoIP trunk without any trouble. They have a 2nd VoIP provider for doing international calls, and some simple dialling rules switch over to that seamlessly.
Next question is: Can you be your own VoIP provider. Yes and no. Depends on the context of the question.